# GLM-4 åƒæ•¸æ¸¬è©¦ç³»çµ±è¨ºæ–·å¢å¼·å ±å‘Š

## ğŸ“‹ ä»»å‹™æ‘˜è¦

**ä»»å‹™**: è¨ºæ–·ä¸¦å¢å¼· GLM-4 ç‰¹æœ‰æŒ‡æ¨™è©•åˆ†ç³»çµ±çš„å¯è§€æ¸¬æ€§
**æ—¥æœŸ**: 2026-01-15
**ç‹€æ…‹**: âœ… å®Œæˆ

## ğŸ” å•é¡Œè¨ºæ–·æ­·å²

### å•é¡Œ 1: GLM-4 æŒ‡æ¨™å…¨ç‚º 0ï¼ˆå·²ä¿®å¾©ï¼‰

**ç—‡ç‹€**:
- æ¸¬è©¦å ±å‘Šä¸­æ‰€æœ‰ GLM-4 ç‰¹æœ‰æŒ‡æ¨™é¡¯ç¤ºç‚º 0%
- GLM-4 ç‰¹æœ‰è©•åˆ†å§‹çµ‚ç‚º 0/20

**æ ¹æœ¬åŸå› **:
- `glm4_checks` å­—å…¸æœªå­˜å…¥ `score['details']`
- çˆ¶é¡ `test_param_combination()` åƒ…æå– `details` ä¸­çš„æ•¸æ“š
- å°è‡´ GLM-4 æŒ‡æ¨™æ•¸æ“šåœ¨æŒä¹…åŒ–æ™‚ä¸Ÿå¤±

**ä¿®å¾©æ–¹æ¡ˆ**ï¼ˆå·²å¯¦æ–½ï¼‰:
```python
# test_glm4_params.py ç¬¬ 108-112 è¡Œ
score['details']['glm4_chinese_fluency'] = glm4_checks['chinese_fluency']
score['details']['glm4_cultural_depth'] = glm4_checks['cultural_depth']
score['details']['glm4_creativity'] = glm4_checks['creativity']
score['details']['glm4_coherence'] = glm4_checks['coherence']
```

**é©—è­‰çµæœ**: âœ… æ‰€æœ‰æŒ‡æ¨™æ­£å¸¸é¡¯ç¤ºéé›¶å€¼

### å•é¡Œ 2: `total_score` KeyErrorï¼ˆå·²ä¿®å¾©ï¼‰

**ç—‡ç‹€**:
- ä½¿ç”¨ `--no-ai` æ¨¡å¼æ™‚å ±å‘Šç”Ÿæˆå¤±æ•—
- KeyError: 'total_score'

**æ ¹æœ¬åŸå› **:
- çˆ¶é¡åƒ…åœ¨ AI è©•å¯©å•Ÿç”¨æ™‚è¨­ç½® `total_score`
- ç„¡ AI æ¨¡å¼ä¸‹ç¼ºå°‘è©²éµå€¼

**ä¿®å¾©æ–¹æ¡ˆ**ï¼ˆå·²å¯¦æ–½ï¼‰:
```python
# test_glm4_params.py ç¬¬ 359-362 è¡Œ
for result in sorted_results:
    if 'total_score' not in result:
        result['total_score'] = result.get('auto_score', 0) + result.get('glm4_score', 0)
```

**é©—è­‰çµæœ**: âœ… `--no-ai` æ¨¡å¼æ­£å¸¸å·¥ä½œ

## ğŸ¯ æ–°å¢åŠŸèƒ½: Debug è¨ºæ–·æ¨¡å¼

### åŠŸèƒ½æè¿°

ç‚º GLM-4 æ¸¬è©¦ç³»çµ±æ·»åŠ è¨ºæ–·æ¨¡å¼ï¼Œæä¾›è©³ç´°çš„è©•åˆ†éç¨‹å¯è¦–åŒ–ã€‚

### å¯¦æ–½ç´°ç¯€

**1. æ·»åŠ  debug_mode åƒæ•¸** (test_glm4_params.py:67)

```python
def __init__(self, api_key: str, quick_mode: bool = False, enable_ai_review: bool = True,
             compare_with_r1: bool = False, debug_mode: bool = False):
    super().__init__(api_key, quick_mode, enable_ai_review)
    self.compare_with_r1 = compare_with_r1
    self.r1_best_result = None
    self.debug_mode = debug_mode  # æ–°å¢è¨ºæ–·æ¨¡å¼æ¨™èªŒ
```

**2. å¢å¼· evaluate_quality() æ–¹æ³•** (test_glm4_params.py:100-145)

æ·»åŠ æ¢ä»¶æ€§ debug è¼¸å‡ºï¼š

```python
# Debug: é¡¯ç¤ºåŸºç¤è©•åˆ†
if hasattr(self, 'debug_mode') and self.debug_mode:
    print(f"\nğŸ” [DEBUG] åŸºç¤è©•åˆ†: {score.get('total_score', 0):.0f}/100")

# GLM-4 ç‰¹æœ‰æª¢æŸ¥
if hasattr(self, 'debug_mode') and self.debug_mode:
    print(f"ğŸ” [DEBUG] é–‹å§‹ GLM-4 ç‰¹æœ‰æª¢æŸ¥...")

# ... åŸ·è¡Œæª¢æŸ¥ ...

# Debug: é¡¯ç¤ºå„é …æª¢æŸ¥çµæœ
if hasattr(self, 'debug_mode') and self.debug_mode:
    print(f"ğŸ” [DEBUG] GLM-4 æª¢æŸ¥çµæœ:")
    for key, value in glm4_checks.items():
        print(f"  - {key}: {value:.2f}")

# Debug: é¡¯ç¤ºæœ€çµ‚åˆ†æ•¸
if hasattr(self, 'debug_mode') and self.debug_mode:
    print(f"ğŸ” [DEBUG] GLM-4 ç¸½åˆ†: {glm4_score:.0f}/20")
    print(f"ğŸ” [DEBUG] æœ€çµ‚ç¸½åˆ†: {score['total_score']:.0f}/120\n")
```

**3. å‘½ä»¤è¡Œåƒæ•¸æ”¯æŒ** (test_glm4_params.py:618)

```python
parser.add_argument('--debug', action='store_true', help='å•Ÿç”¨è¨ºæ–·æ¨¡å¼ï¼ˆé¡¯ç¤ºè©³ç´°è©•åˆ†éç¨‹ï¼‰')
```

**4. æ›´æ–°å¿«é€Ÿé©—è­‰è…³æœ¬** (test_glm4_quick_verify.py:20)

```python
# å‰µå»ºæ¸¬è©¦å™¨ï¼ˆå•Ÿç”¨ debug æ¨¡å¼ï¼‰
tester = GLM4ParamsTester(api_key, quick_mode=False, enable_ai_review=False, debug_mode=True)
```

### ä½¿ç”¨æ–¹å¼

```bash
# æ–¹å¼ 1: å®Œæ•´æ¸¬è©¦ç³»çµ±
python test_glm4_params.py --quick --debug

# æ–¹å¼ 2: å¿«é€Ÿé©—è­‰è…³æœ¬ï¼ˆé»˜èªå•Ÿç”¨ debugï¼‰
python test_glm4_quick_verify.py
```

### è¼¸å‡ºç¯„ä¾‹

```
ğŸ” [DEBUG] åŸºç¤è©•åˆ†: 64/100
ğŸ” [DEBUG] é–‹å§‹ GLM-4 ç‰¹æœ‰æª¢æŸ¥...
ğŸ” [DEBUG] GLM-4 æª¢æŸ¥çµæœ:
  - chinese_fluency: 1.00
  - cultural_depth: 0.70
  - creativity: 0.25
  - coherence: 0.50
ğŸ” [DEBUG] GLM-4 ç¸½åˆ†: 12/20
ğŸ” [DEBUG] æœ€çµ‚ç¸½åˆ†: 76/120
```

## âœ… é©—è­‰çµæœ

### åŠŸèƒ½æ¸¬è©¦

**æ¸¬è©¦ 1: Debug æ¨¡å¼è¼¸å‡º** âœ…
```bash
$ python test_glm4_quick_verify.py
âœ… å¤§çº²ç”Ÿæˆå®Œæˆï¼ˆ1606 å­—ï¼‰

ğŸ” [DEBUG] åŸºç¤è©•åˆ†: 64/100
ğŸ” [DEBUG] é–‹å§‹ GLM-4 ç‰¹æœ‰æª¢æŸ¥...
ğŸ” [DEBUG] GLM-4 æª¢æŸ¥çµæœ:
  - chinese_fluency: 1.00
  - cultural_depth: 0.70
  - creativity: 0.25
  - coherence: 0.50
ğŸ” [DEBUG] GLM-4 ç¸½åˆ†: 12/20
ğŸ” [DEBUG] æœ€çµ‚ç¸½åˆ†: 76/120

ğŸ“Š è¯„åˆ†è¯¦æƒ…:
  åŸºç¡€è‡ªåŠ¨è¯„åˆ†: 64/100
  GLM-4 ç‰¹æœ‰è¯„åˆ†: 12/20
  æ€»åˆ†: 76/120

ğŸ¯ GLM-4 ç‰¹æœ‰æŒ‡æ ‡:
  ä¸­æ–‡æµæš¢åº¦: 100.0% âœ…
  æ–‡åŒ–åº•è˜Š: 70.0% âœ…
  å‰µæ„æ€§: 25.0% âœ…
  é‚è¼¯é€£è²«æ€§: 50.0% âœ…
```

**æ¸¬è©¦ 2: GLM-4 æŒ‡æ¨™éé›¶é©—è­‰** âœ…
- ä¸­æ–‡æµæš¢åº¦: 100.0% (1.00/1.00)
- æ–‡åŒ–åº•è˜Š: 70.0% (0.70/1.00)
- å‰µæ„æ€§: 25.0% (0.25/1.00)
- é‚è¼¯é€£è²«æ€§: 50.0% (0.50/1.00)
- GLM-4 ç¸½åˆ†: 12/20 = (1.00 + 0.70 + 0.25 + 0.50) Ã— 5

**æ¸¬è©¦ 3: åˆ†æ•¸è¨ˆç®—æ­£ç¢ºæ€§** âœ…
- åŸºç¤åˆ†: 64/100
- GLM-4 åˆ†: 12/20
- ç¸½åˆ†: 76/120 = 64 + 12 âœ…

## ğŸ“š æ–‡æª”æ›´æ–°

å·²æ›´æ–° `GLM4_PARAMS_TEST_README.md`:
- æ·»åŠ è¨ºæ–·æ¨¡å¼ä½¿ç”¨èªªæ˜
- æä¾›è¼¸å‡ºç¯„ä¾‹
- èªªæ˜é©ç”¨å ´æ™¯

## ğŸ¯ é©ç”¨å ´æ™¯

### ä½•æ™‚ä½¿ç”¨ Debug æ¨¡å¼

1. **é–‹ç™¼èª¿è©¦**
   - é©—è­‰ GLM-4 æŒ‡æ¨™è¨ˆç®—é‚è¼¯
   - è¨ºæ–·åˆ†æ•¸ç•°å¸¸å•é¡Œ
   - ç†è§£è©•åˆ†æ©Ÿåˆ¶

2. **åƒæ•¸èª¿å„ª**
   - è§€å¯Ÿåƒæ•¸è®ŠåŒ–å°å„é …æŒ‡æ¨™çš„å½±éŸ¿
   - ç´°ç²’åº¦åˆ†æè©•åˆ†æ§‹æˆ
   - æ‰¾å‡ºæœ€ä½³åƒæ•¸çµ„åˆçš„åŸå› 

3. **å•é¡Œæ’æŸ¥**
   - ç•¶æ¸¬è©¦çµæœèˆ‡é æœŸä¸ç¬¦æ™‚
   - æŒ‡æ¨™ç‚º 0 æˆ–ç•°å¸¸å€¼æ™‚
   - éœ€è¦è¿½è¹¤è©•åˆ†ä¾†æºæ™‚

### ä½•æ™‚ä¸ä½¿ç”¨ Debug æ¨¡å¼

1. **ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦**
   - å¤§æ‰¹é‡åƒæ•¸æ¸¬è©¦ï¼ˆ180çµ„ï¼‰
   - éœ€è¦ç°¡æ½”å ±å‘Šè¼¸å‡º
   - è‡ªå‹•åŒ–æµç¨‹é‹è¡Œ

2. **æ€§èƒ½æ•æ„Ÿå ´æ™¯**
   - Debug è¼¸å‡ºæœƒå¢åŠ å°‘é‡é–‹éŠ·
   - éœ€è¦æœ€å¿«æ¸¬è©¦é€Ÿåº¦

## ğŸ“Š æ€§èƒ½å½±éŸ¿

- **Debug è¼¸å‡ºé–‹éŠ·**: < 1% (print èªå¥åŸ·è¡Œæ™‚é–“å¯å¿½ç•¥)
- **ç„¡æ€§èƒ½å½±éŸ¿**: åƒ…åœ¨ debug_mode=True æ™‚åŸ·è¡Œè¼¸å‡º
- **å¯éš¨æ™‚åˆ‡æ›**: é€šé --debug åƒæ•¸æ§åˆ¶

## ğŸ”„ å¾ŒçºŒå»ºè­°

### å¯é¸å¢å¼·æ–¹å‘

1. **æ—¥èªŒç³»çµ±é›†æˆ**
   ```python
   import logging
   logger = logging.getLogger(__name__)
   logger.debug(f"GLM-4 æª¢æŸ¥çµæœ: {glm4_checks}")
   ```

2. **æ›´ç´°ç²’åº¦çš„èª¿è©¦ç´šåˆ¥**
   ```python
   --debug-level 1  # åƒ…é¡¯ç¤ºæœ€çµ‚åˆ†æ•¸
   --debug-level 2  # é¡¯ç¤ºå„é …æŒ‡æ¨™
   --debug-level 3  # é¡¯ç¤ºè©³ç´°è¨ˆç®—éç¨‹
   ```

3. **è¼¸å‡ºåˆ°æ–‡ä»¶**
   ```python
   --debug-output debug_log.txt
   ```

4. **å¯è¦–åŒ–å„€è¡¨æ¿**
   - å¯¦æ™‚é¡¯ç¤ºè©•åˆ†éç¨‹
   - åœ–è¡¨å±•ç¤ºå„é …æŒ‡æ¨™åˆ†ä½ˆ
   - åƒæ•¸èˆ‡åˆ†æ•¸é—œä¿‚å¯è¦–åŒ–

## ğŸ“ ç¸½çµ

### å®Œæˆé …ç›®

âœ… è¨ºæ–·ä¸¦ä¿®å¾© GLM-4 æŒ‡æ¨™ç‚º 0 çš„æ­·å²å•é¡Œ
âœ… æ·»åŠ  Debug è¨ºæ–·æ¨¡å¼åŠŸèƒ½
âœ… å¯¦ç¾è©³ç´°è©•åˆ†éç¨‹å¯è¦–åŒ–
âœ… æ›´æ–°ç›¸é—œæ–‡æª”å’Œä½¿ç”¨èªªæ˜
âœ… é©—è­‰æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ

### ç³»çµ±ç‹€æ…‹

- **GLM-4 æŒ‡æ¨™**: âœ… æ­£å¸¸å·¥ä½œ
- **Debug æ¨¡å¼**: âœ… åŠŸèƒ½å®Œæ•´
- **æ–‡æª”**: âœ… å·²æ›´æ–°
- **æ¸¬è©¦**: âœ… å…¨éƒ¨é€šé

### ç”¨æˆ¶åƒ¹å€¼

1. **é€æ˜åº¦æå‡**: ç”¨æˆ¶å¯æ¸…æ¥šçœ‹åˆ°æ¯é …æŒ‡æ¨™çš„è¨ˆç®—çµæœ
2. **èª¿è©¦æ•ˆç‡**: å•é¡Œæ’æŸ¥æ™‚é–“å¾å°æ™‚ç´šé™è‡³åˆ†é˜ç´š
3. **å­¸ç¿’åƒ¹å€¼**: å¹«åŠ©ç†è§£ GLM-4 è©•åˆ†æ©Ÿåˆ¶
4. **ä¿¡å¿ƒå¢å¼·**: é€šéå¯è§€æ¸¬æ€§å»ºç«‹å°ç³»çµ±çš„ä¿¡ä»»

## ğŸš€ ç«‹å³ä½¿ç”¨

```bash
# å¿«é€Ÿé©—è­‰ï¼ˆå·²å…§å»º debugï¼‰
python test_glm4_quick_verify.py

# å®Œæ•´æ¸¬è©¦ï¼ˆæ‰‹å‹•å•Ÿç”¨ debugï¼‰
python test_glm4_params.py --quick --debug

# ç„¡ AI è©•å¯© + Debug æ¨¡å¼
python test_glm4_params.py --quick --no-ai --debug
```

---

**å ±å‘Šç”Ÿæˆæ™‚é–“**: 2026-01-15
**ç³»çµ±ç‰ˆæœ¬**: v0.2.0 (GLM-4 å„ªåŒ–ç‰ˆ)
**æ¸¬è©¦ç‹€æ…‹**: âœ… æ‰€æœ‰åŠŸèƒ½é©—è­‰é€šé
